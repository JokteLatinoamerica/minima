/**
 * @version     0.8
 * @package     Minima
 * @author      Marco Barbosa
 * @copyright   Copyright (C) 2010 Marco Barbosa. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */

(function(){var c;var d=function(a){var b=$(a.target);var e=b.getParents();c.each(function(f){var h=f.element;if(h!=b&&!e.contains(h)){f.fn.call(h,a)}})};Element.Events.outerClick={onAdd:function(a){if(!c){document.addEvent("click",d);c=[]}c.push({element:this,fn:a})},onRemove:function(a){c=c.filter(function(b){return b.element!=this||b.fn!=a},this);if(!c.length){document.removeEvent("click",d);c=null}}}})();Element.implement("switchClass",function(e,d){var c=this.hasClass(e);this.removeClass(c?e:d).addClass(c?d:e);return this});$extend(Selectors.Pseudo,{visible:function(){if(this.getStyle("visibility")!="hidden"&&this.isVisible()&&this.isDisplayed()){return this}}});var ElementFilter=new Class({Implements:[Options,Events],options:{cache:true,caseSensitive:false,ignoreKeys:[13,27,32,37,38,39,40],matchAnywhere:true,property:"text",trigger:"keyup",onStart:$empty,onShow:$empty,onHide:$empty,onComplete:$empty},initialize:function(f,d,e){this.setOptions(e);this.observeElement=document.id(f);this.elements=$$(d);this.matches=this.elements;this.misses=[];this.listen()},listen:function(){this.observeElement.addEvent(this.options.trigger,function(b){if(this.observeElement.value.length){if(!this.options.ignoreKeys.contains(b.code)){this.fireEvent("start");this.findMatches(this.options.cache?this.matches:this.elements);this.fireEvent("complete")}}else{this.findMatches(this.elements,false)}}.bind(this))},findMatches:function(k,h){var l=this.observeElement.value;var i=this.options.matchAnywhere?l:"^"+l;var j=this.options.caseSensitive?"":"i";var n=new RegExp(i,j);var m=[];k.each(function(a){var b=(h==undefined?n.test(a.get(this.options.property)):h);if(b){if(!a.retrieve("showing")){this.fireEvent("show",[a])}m.push(a);a.store("showing",true)}else{if(a.retrieve("showing")){this.fireEvent("hide",[a])}a.store("showing",false)}return true}.bind(this));return m}});var MyPanelClass=new Class({Implements:[Options],panelStatus:{"true":"active","false":"inactive"},panel:null,options:{prev:"",next:"",panelList:"",panelPage:"",panelWrapper:"",toIncrement:0,increment:900},maxRightIncrement:null,panelSlide:null,numberOfExtensions:null,initialize:function(b){this.setOptions(b);this.panel=new Fx.Slide.Mine(this.options.panelWrapper,{mode:"vertical",transition:Fx.Transitions.Pow.easeOut}).hide();if(this.options.next){this.panelSlide=new Fx.Tween(this.options.panelList,{duration:500,transition:"back:in:out"});this.numberOfExtensions=this.options.panelList.getChildren("li").length;this.options.panelList.setStyle("width",Math.round(this.numberOfExtensions/9)*this.options.increment);this.maxRightIncrement=-Math.ceil(this.options.panelPage.getChildren().length*this.options.increment-this.options.increment);this.showButtons()}},helloWorld:function(){alert("cool")},doPrevious:function(){if(this.options.toIncrement<0){this.options.next.show();this.options.toIncrement+=this.options.increment;this.panelSlide.pause();this.panelSlide.start("margin-left",this.options.toIncrement);this.options.panelPage.getFirst(".current").removeClass("current").getPrevious("li").addClass("current");this.showButtons()}},doNext:function(){if(this.options.toIncrement>this.maxRightIncrement){this.options.prev.show();this.options.toIncrement-=this.options.increment;this.panelSlide.pause();this.panelSlide.start("margin-left",this.options.toIncrement);this.options.panelPage.getFirst(".current").removeClass("current").getNext("li").addClass("current");this.showButtons()}},changeToPage:function(c){var d=c.id.substr("panel-pagination-".length);this.panelSlide.pause();this.options.toIncrement=Math.ceil(0-this.options.increment*d);this.panelSlide.start("margin-left",this.options.toIncrement);this.options.panelPage.getFirst(".current").removeClass("current");c.addClass("current");this.showButtons()},showButtons:function(){if(this.options.toIncrement==0){this.options.prev.hide()}else{this.options.prev.show()}if(this.options.toIncrement==this.maxRightIncrement){this.options.next.hide()}else{this.options.next.show()}}});var ScrollSpy=new Class({Implements:[Options,Events],options:{container:window,max:0,min:0,mode:"vertical"},initialize:function(b){this.setOptions(b);this.container=document.id(this.options.container);this.enters=this.leaves=0;this.inside=false;this.listener=function(e){var a=this.container.getScroll(),f=a[this.options.mode=="vertical"?"y":"x"];if(f>=this.options.min&&(this.options.max==0||f<=this.options.max)){if(!this.inside){this.inside=true;this.enters++;this.fireEvent("enter",[a,this.enters,e])}this.fireEvent("tick",[a,this.inside,this.enters,this.leaves,e])}else{if(this.inside){this.inside=false;this.leaves++;this.fireEvent("leave",[a,this.leaves,e])}}this.fireEvent("scroll",[a,this.inside,this.enters,this.leaves,e])};this.addListener()},start:function(){this.container.addEvent("scroll",this.listener.bind(this))},stop:function(){this.container.removeEvent("scroll",this.listener.bind(this))},addListener:function(){this.start()}});window.addEvent("load",function(){});window.addEvent("domready",function(){(function(M){this.IPhoneCheckboxes=new Class({Implements:[Options],options:{checkedLabel:"ON",uncheckedLabel:"OFF",background:"#fff",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleBGClass:"iPhoneCheckHandleBG",handleSliderClass:"iPhoneCheckHandleSlider",elements:"input[type=checkbox].check"},initialize:function(N){this.setOptions(N);this.elements=$$(this.options.elements);this.elements.each(function(O){this.observe(O)},this)},observe:function(S){S.set("opacity",0);var T=new Element("div",{"class":this.options.containerClass}).inject(S.getParent());S.inject(T);var Q=new Element("div",{"class":this.options.handleClass}).inject(T);var U=new Element("div",{"class":this.options.handleBGClass,style:this.options.background}).inject(Q);var O=new Element("div",{"class":this.options.handleSliderClass}).inject(Q);var N=new Element("label",{"class":this.options.labelOffClass,text:this.options.uncheckedLabel}).inject(T);var R=new Element("label",{"class":this.options.labelOnClass,text:this.options.checkedLabel}).inject(T);var P=T.getSize().x-39;S.offFx=new Fx.Tween(N,{property:"opacity",duration:200});S.onFx=new Fx.Tween(R,{property:"opacity",duration:200});T.addEvent("mouseup",function(){var V=!S.checked;var X=(V?P:0);var W=(V?34:0);U.hide();new Fx.Tween(Q,{duration:100,property:"left",onComplete:function(){U.setStyle("left",W).show()}}).start(X);if(V){S.offFx.start(0);S.onFx.start(1)}else{S.offFx.start(1);S.onFx.start(0)}S.set("checked",V)});if(S.checked){N.set("opacity",0);R.set("opacity",1);Q.setStyle("left",P);U.setStyle("left",34)}else{R.set("opacity",0);U.setStyle("left",0)}}})})(document.id);var s=MooTools.lang.get("Minima");var c=$$(".toolbar-list li a");var p=$("toolbar");var g=new Array();var h=new Array();var w=$("filter-bar");var m=$("content-top");var e=$("tophead");if(c.length){c.each(function(M){if(M.get("onclick")!=null&&M.get("onclick").contains("if")){g.push(M.getParent("li"))}else{if(M.get("class")!="divider"){h.push(M.getParent("li"))}}})}if(g.length){var x=new Element("ul",{id:"actions"}).hide();g=g.sort(function(N,M){if(N.get("text").toLowerCase()<M.get("text").toLowerCase()){return -1}if(N.get("text").toLowerCase()==M.get("text").toLowerCase()){return 0}return 1});g.each(function(M,N){x.grab(M)});var J=new Element("li",{id:"bulkActions",events:{click:function(M){x.toggle();$$("#bulkActions > a:first-child").switchClass("active","inactive");this.switchClass("active","inactive")},outerClick:function(){x.hide();$$("#bulkActions > a:first-child").set("class","inactive")}}});var E=new Element("a",{html:s.actionBtn});var f=new Element("span",{"class":"arrow"});var b=($("toolbar-new"))?"ul > li#toolbar-new":"ul > li";J.inject($("toolbar").getElement(b),"after");$("bulkActions").grab(E);E.grab(f);$("bulkActions").grab(x)}if(p){p.show()}$(document.body).addClass("ready");var K=$$(".adminlist");if(K.length){K.set("id","adminlist")}if($("submenu")){$("submenu").addClass("minimaTabs")}var D=$("system-message");if(D&&D.getElement("ul li:last-child")){var a=new Element("a",{href:"#",id:"hide-system-message",html:"hide",events:{click:function(M){D.dissolve({duration:"short"})}}});D.show().getElement("ul li:last-child").adopt(a)}if($("rules")){$$(".jpane-toggler").addEvent("click",function(){var M=this.getNext(".jpane-slider").getElement("caption");if(M){M.set("tween",{duration:"2000"}).highlight("#ffd")}})}var z=$("submenu");var o=$("item-form");if((z&&z.hasClass("out"))||(z&&$("item-form"))){if(o){o.getChildren("div").addClass("hide")}z.inject($("content"),"top")}if(z&&$("item-form")){var k=$$(".minimaTabs a"),B=o.getChildren("div").addClass("hide");B[0].removeClass("hide");k.each(function(N,M){N.addEvents({click:function(O){O.stop();k.removeClass("active");this.addClass("active");B.addClass("hide");B[M].removeClass("hide")}})});var A=$$("#advanced-tabs a"),q=$("tabs").getChildren(".panelform").addClass("hide");q[0].removeClass("hide");A.each(function(N,M){N.addEvents({click:function(O){O.stop();A.removeClass("active");this.addClass("active");q.addClass("hide");q[M].removeClass("hide")}})})}if(!w&&$$(".adminlist")){$$(".adminlist").addClass("padTop")}if($$(".adminlist").length){var y=$$("input[name=checkall-toggle]");y.addEvent("click",function(){var M=$$(".adminlist tbody tr");M.toggleClass("selected")});$$(".adminlist tbody tr input[type=checkbox]").each(function(M){var N=M.getParent("tr");var O=$$("input[name=boxchecked]");M.addEvent("click",function(P){P&&P.stopPropagation();if(M.checked){N.addClass("selected")}else{N.removeClass("selected")}});N.addEvent("click",function(){if(M.checked){M.set("checked",false);O.set("value",0)}else{M.set("checked",true);O.set("value",1)}M.fireEvent("click")})});var G=$("adminlist").getElements("th img");G.getParent("th").addClass("active")}if($("jform_title")){if($("jform_title").get("value")!=""){$$(".pagetitle h2").set("html",$("jform_title").get("value"))}$("jform_title").addEvent("keyup",function(M){if($("jform_title").get("value")!=""){$$(".pagetitle h2").set("html",this.get("value"))}$("jform_alias").set("value",this.get("value").standardize().replace(/\s+/g,"-").replace(/[^-\w]+/g,"").toLowerCase())})}if(w){var H={"true":s.closeFilter,"false":s.showFilter};var n=new Fx.Slide(w).hide();var v=new Element("a",{href:"#minima",id:"open-filter",html:s.closeFilter,events:{click:function(M){M.stop();n.toggle();this.toggleClass("active");if(this.hasClass("active")){$("filter_search").focus()}if(m.hasClass("fixed")){window.scrollTo(0,0)}}}});var j=false;var d="";w.getElements("input, select").each(function(M){var N=M.get("value");if(N&&N!=0&&N!="*"){j=true;d+=(M.get("tag").toLowerCase()=="select")?M.getElement("option:selected").get("html").toLowerCase()+" ":d+=N.toLowerCase()+" "}});if(j){n.show()}v.set("html",H[n.open]);var t=$$(".pagetitle").getElement("h2");if(d){t.set("html",t.get("html")+"<em>( "+d+")</em>")}n.addEvent("complete",function(){v.set("html",H[n.open])});$$(".pagetitle").grab(v);w.show()}var l=new ScrollSpy({min:80,onEnter:function(){if(document.body.hasClass("locked")){m.setStyle("left",(e.getSize().x-1140)/2)}m.setStyle("width",e.getSize().x-40).addClass("fixed")},onLeave:function(){m.removeClass("fixed");if(document.body.hasClass("locked")){m.setStyle("width","100%")}}});var I=$("panel-wrapper");if(I){Fx.Slide.Mine=new Class({Extends:Fx.Slide,initialize:function(N,M){this.parent(N,M);this.wrapper=this.element.getParent()}});var C=new MyPanelClass({panelWrapper:$("panel-wrapper"),prev:$("prev"),next:$("next"),panelList:$("panel-list"),panelPage:$("panel-pagination")});$("prev").addEvent("click",function(){C.doPrevious()});$("next").addEvent("click",function(){C.doNext()});$("panel-pagination").getChildren("li").addEvent("click",function(){C.changeToPage(this)});var L=$("more");var u=$("list-content");var i=$("panel-tab");var r=$("list-wrapper");i.addEvents({click:function(){C.panel.toggle()},outerClick:function(){}});C.panel.addEvent("complete",function(){i.set("class",C.panelStatus[C.panel.open])});L.addEvent("click",function(){this.switchClass("active","inactive");u.toggle()});var F=function(){L.set("class","inactive");r.removeClass("active");u.hide()};r.addEvent("outerClick",function(){F()});u.getElements("a").addEvent("click",function(){F()});$$("#panel-list li").addEvent("click",function(){panel.toggle()})}});
