/**
 * @version     0.8
 * @package     Minima
 * @author      Marco Barbosa
 * @copyright   Copyright (C) 2010 Webnific. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */

/* Special thanks to these great guys at #mootools:
 * d_mitar
 * rev087
 * keeto
 * FunFactor
 * csuwldcat
 * rpflo
 * Oskar__
 * boushley
 * Garrick
 * fakedarren
 * THANK YOU for the kind help. You guys helped more than you think (m4co)
 * */

(function(){var b;var a=function(f){var d=$(f.target);var c=d.getParents();b.each(function(g){var e=g.element;if(e!=d&&!c.contains(e)){g.fn.call(e,f)}})};Element.Events.outerClick={onAdd:function(c){if(!b){document.addEvent("click",a);b=[]}b.push({element:this,fn:c})},onRemove:function(c){b=b.filter(function(d){return d.element!=this||d.fn!=c},this);if(!b.length){document.removeEvent("click",a);b=null}}}})();Element.implement("switchClass",function(e,d){var c=this.hasClass(e);this.removeClass(c?e:d).addClass(c?d:e);return this});window.addEvent("load",function(){});window.addEvent("domready",function(){var s=MooTools.lang.get("Minima");var c=$$(".toolbar-list li a");var j=new Array();var k=new Array();if(c.length){c.each(function(Q){if(Q.get("onclick")!=null&&Q.get("onclick").contains("if")){j.push(Q.getParent("li"))}else{if(Q.get("class")!="divider"){k.push(Q.getParent("li"))}}})}if(j.length){var x=new Element("ul",{id:"actions"}).hide();j=j.sort(function(R,Q){if(R.get("text").toLowerCase()<Q.get("text").toLowerCase()){return -1}if(R.get("text").toLowerCase()==Q.get("text").toLowerCase()){return 0}return 1});j.each(function(Q,R){x.grab(Q)});var N=new Element("li",{id:"bulkActions",events:{click:function(){x.toggle();$$("#bulkActions > a:first-child").switchClass("active","inactive");this.switchClass("active","inactive")},outerClick:function(){x.hide();$$("#bulkActions > a:first-child").set("class","inactive")}}});var J=new Element("a",{html:s.actionBtn,href:"#"});var h=new Element("span",{"class":"arrow"});var b=($("toolbar-new"))?"ul > li#toolbar-new":"ul > li";N.inject($("toolbar").getElement(b),"after");$("bulkActions").grab(J);J.grab(h);$("bulkActions").grab(x)}$(document.body).addClass("ready");$(document.body).removeClass("no-js");if($$(".adminlist").length){$$(".adminlist").set("id","adminlist")}if($("submenu")){$("submenu").addClass("minimaTabs")}var i=$("header");if(i){var B=$("logo").getElement("img").getHeight();i.setStyle("height",B)}var I=$("system-message");if(I){var a=new Element("a",{href:"#",id:"hide-system-message",html:"hide",events:{click:function(Q){I.dissolve({duration:"short"})}}});I.getElement("ul li:last-child").adopt(a)}var C=$("submenu");if(!C&&$("toolbar-box")){$("toolbar-box").addClass("borderLeft")}else{if($("item-form")){C.inject($("content"),"top");var o=$$(".minimaTabs a"),E=$("item-form").getChildren("div").addClass("hide");E[0].removeClass("hide");o.each(function(R,Q){R.addEvents({click:function(S){S.stop();o.removeClass("active");this.addClass("active");E.addClass("hide");E[Q].removeClass("hide")}})});var D=$$("#advanced-tabs a"),r=$("tabs").getChildren(".panelform").addClass("hide");r[0].removeClass("hide");D.each(function(R,Q){R.addEvents({click:function(S){S.stop();D.removeClass("active");this.addClass("active");r.addClass("hide");r[Q].removeClass("hide")}})})}}if(!$("filter-bar")&&$$(".adminlist")){$$(".adminlist").addClass("padTop")}if($$(".adminlist").length){var y=$$("input[name=checkall-toggle]");y.addEvent("click",function(){var Q=$$(".adminlist tbody tr");Q.toggleClass("selected")});$$(".adminlist tbody tr input[type=checkbox]").each(function(Q){var R=Q.getParent("tr");var S=$$("input[name=boxchecked]");Q.addEvent("click",function(T){T&&T.stopPropagation();if(Q.checked){R.addClass("selected")}else{R.removeClass("selected")}});R.addEvent("click",function(){if(Q.checked){Q.set("checked",false);S.set("value",0)}else{Q.set("checked",true);S.set("value",1)}Q.fireEvent("click")})});var K=$("adminlist").getElements("th img");K.getParent("th").addClass("active")}if($("jform_title")){if($("jform_title").get("value")!=""){$$(".pagetitle h2").set("html",$("jform_title").get("value"))}$("jform_title").addEvent("keyup",function(Q){if($("jform_title").get("value")!=""){$$(".pagetitle h2").set("html",this.get("value"))}$("jform_alias").set("value",this.get("value").standardize().replace(/\s+/g,"-").replace(/[^-\w]+/g,"").toLowerCase())})}if($("filter-bar")){var G=$("filter-bar").hide();var L={"true":s.closeFilter,"false":s.showFilter};var p=new Fx.Slide(G).hide();var w=new Element("a",{href:"#",id:"open-filter",html:s.closeFilter,events:{click:function(Q){Q.stop();p.toggle();this.toggleClass("active")}}});var n=false;var e="";G.getElements("input, select").each(function(Q){var R=Q.get("value");if(R&&R!=0&&R!="*"){n=true;e+=(Q.get("tag").toLowerCase()=="select")?Q.getElement("option:selected").get("html").toLowerCase()+" ":e+=R.toLowerCase()+" "}});if(n){p.show()}w.set("html",L[p.open]);var t=$$(".pagetitle").getElement("h2");if(e){t.set("html",t.get("html")+"<em>( "+e+")</em>")}p.addEvent("complete",function(){w.set("html",L[p.open])});$$(".pagetitle").grab(w);G.show()}var M=$("panel-wrapper");if(M){var m={"true":"active","false":"inactive"};Fx.Slide.Mine=new Class({Extends:Fx.Slide,initialize:function(R,Q){this.parent(R,Q);this.wrapper=this.element.getParent();this.wrapper.setStyles({})},onStart:function(){}});var q=new Fx.Slide.Mine(M,{mode:"vertical",transition:Fx.Transitions.Pow.easeOut}).hide();var A=$("prev");var f=$("next");var v=$("panel-list");if(f){var H=0,F=900;var O=new Fx.Tween(v,{duration:500,transition:"back:in:out"});var z=v.getChildren("li").length;v.setStyle("width",Math.round(z/9)*900);var d=(F*-(Math.ceil(z/9)))+900;var g=$("panel-pagination");A.addEvent("click",function(){console.log(H,"< 0");if(H<0){H+=F;O.pause();O.start("margin-left",H);g.getFirst(".current").removeClass("current").getPrevious("li").addClass("current")}});f.addEvent("click",function(){if(H>d){H-=F;O.pause();O.start("margin-left",H);g.getFirst(".current").removeClass("current").getNext("li").addClass("current")}})}var P=$("more");var u=$("list-content").hide();var l=$("panel-tab");if(!P.hasClass("disabled")&&!l.hasClass("disabled")){l.addEvents({click:function(){q.toggle()},outerClick:function(){}});q.addEvent("complete",function(){l.set("class",m[q.open])});P.addEvent("mouseenter",function(){this.getParent().addClass("active");u.show()});$("list-wrapper").addEvent("mouseleave",function(){this.removeClass("active");u.hide()})}}});
